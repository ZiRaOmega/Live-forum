<!DOCTYPE html>
<html>
  <head>
    <title>Real-time Chat</title>
  </head>
  <body>
    <div id="chat-container">
      <div id="message-container"></div>
      <form id="message-form">
        <input type="text" id="username" placeholder="Enter your name">
        <input type="text" id="email" placeholder="Enter your email">
        <input type="text" id="message" placeholder="Enter your message">
        <button type="submit">Send</button>
      </form>
    </div>
    <script>
      window.onload = function(){
      // Connect to the websocket server
      let socket = new WebSocket("ws://localhost:8000/ws")

      let username = document.getElementById("username")
      let email = document.getElementById("email")
      let message = document.getElementById("message")
      let messageContainer = document.getElementById("message-container")
      let form = document.getElementById("message-form")

      // Handle form submission
      form.addEventListener("submit", e => {
        e.preventDefault()
        let msg = {
          Email: email.value,
          Username: username.value,
          Message: message.value
        }

        // Send message to the server
        socket.send(JSON.stringify(msg))

        // Clear message input
        message.value = ""
      })

      // Handle message from the server
      socket.onmessage = e => {
        let msg = JSON.parse(e.data)
        let message = document.createElement("div")
        message.innerHTML = `<b>${msg.username}</b>: ${msg.message}`
        messageContainer.appendChild(message)
      }
    }
    </script>
  </body>
</html>
